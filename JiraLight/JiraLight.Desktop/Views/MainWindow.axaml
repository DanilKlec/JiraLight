<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:JiraLight.Desktop.ViewModels"
		xmlns:local="clr-namespace:JiraLight.Desktop.ViewModels"
        x:Class="JiraLight.Desktop.Views.MainWindow"
        Width="1450" Height="800"
        CanResize="True"
        TransparencyLevelHint="AcrylicBlur"
		Background="Transparent"
        Title="Jira Light"
		ExtendClientAreaToDecorationsHint="True"
ExtendClientAreaChromeHints="NoChrome"
ExtendClientAreaTitleBarHeightHint="50">

	<Window.DataContext>
		<vm:MainViewModel/>
	</Window.DataContext>

	<Window.Resources>
		<local:StringToOpacityConverter x:Key="StringToOpacityConverter"/>
	</Window.Resources>

	<Window.Styles>
		<Style Selector="TextBox">
			<Setter Property="Background" Value="#adaaaa"/>
			<Setter Property="Foreground" Value="Black"/>
			<Setter Property="CaretBrush" Value="Black"/>
			<Setter Property="SelectionBrush" Value="#80FFFFFF"/>
			<Setter Property="Template">
				<ControlTemplate>
					<Border Background="{TemplateBinding Background}"
							CornerRadius="8"
							BorderBrush="{TemplateBinding BorderBrush}"
							BorderThickness="{TemplateBinding BorderThickness}">
						<Grid>
							<!-- ScrollViewer с текстом -->
							<ScrollViewer x:Name="PART_ScrollViewer"
										  Padding="{TemplateBinding Padding}">
								<TextPresenter x:Name="PART_TextPresenter"
											   Text="{TemplateBinding Text}"
											   CaretBrush="{TemplateBinding CaretBrush}"
											   SelectionBrush="{TemplateBinding SelectionBrush}"/>
							</ScrollViewer>

							<!-- Watermark реализуем через TextBlock -->
							<TextBlock Name="PART_CustomWatermark"
									   Text="{TemplateBinding Watermark}"
									   Foreground="Gray"
									   Margin="8,0,0,0"
									   VerticalAlignment="Center"
									   IsHitTestVisible="False"
									   Opacity="{Binding Text, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource StringToOpacityConverter}}"/>
						</Grid>
					</Border>
				</ControlTemplate>
			</Setter>
		</Style>
	</Window.Styles>
	<DockPanel>
		<Border DockPanel.Dock="Top" Background="#0078D7" Height="50" CornerRadius="12,12,0,0"
                    PointerPressed="TopBar_OnPointerPressed">
			<DockPanel>
				<TextBlock Text="Jira Light" VerticalAlignment="Center"
						   Margin="15,0" FontSize="16" FontWeight="Bold" Foreground="White"/>

				<!-- Навигация -->
				<StackPanel Orientation="Horizontal" Margin="20,0,0,0" IsVisible="{Binding IsLoggedIn}">

					<Button Content="Главная"
							Command="{Binding NavigateDashboardCommand}"
							Margin="20,10"
							Background="#005A9E"
							Foreground="White"/>
					<Button Content="Задачи"
							Command="{Binding OpenTaskListCommand}"
							Margin="10,10"
							Background="#FFA500"
							Foreground="White"
							IsVisible="{Binding IsAdmin}"/>
					<Button Content="Пользователи"
							Command="{Binding OpenUserListCommand}"
							Margin="10,10"
							Background="#FFA500"
							Foreground="White"
							IsVisible="{Binding IsAdmin}"/>
					<Button Content="Добавить задачу"
							Command="{Binding OpenAddTaskDialogCommand}"
							Margin="10,10"
							Background="#FFA500"
							Foreground="White"/>
				</StackPanel>

				<!-- Кнопки управления окном -->
				<StackPanel Orientation="Horizontal" DockPanel.Dock="Right" HorizontalAlignment="Right" Spacing="5">
					<Button x:Name="MinimizeButton" Content="—" Width="32" Height="32"
							Background="Transparent" BorderThickness="0" Foreground="White"/>
					<Button x:Name="MaximizeButton" Content="◻" Width="32" Height="32"
							Background="Transparent" BorderThickness="0" Foreground="White"/>
					<Button x:Name="CloseButton" Content="✕" Width="32" Height="32"
							Background="Transparent" BorderThickness="0" Foreground="#e53935"/>
				</StackPanel>
			</DockPanel>
		</Border>
		<!-- Область для страниц -->
		<Border CornerRadius="5"
                Margin="10"
                Padding="10"
			Background="Transparent">
			<ContentControl Content="{Binding CurrentPage}"/>
		</Border>

	</DockPanel>
</Window>
